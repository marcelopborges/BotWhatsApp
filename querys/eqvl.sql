SELECT m.DATA_RECEITA,n.META,m.EQVL, ROUND((m.EQVL/n.META-1)*100,2) AS DESV FROM (SELECT a.DATA_RECEITA, round(a.RECEITA / (a.DEMANDA * b.TARIFA_CONVENCIONAL)*100,2) as EQVL FROM (select DATA_RECEITA, SUM(RECEITA) AS RECEITA,  SUM(PASSAGEIROS_TOTAL) AS DEMANDA from demanda GROUP BY DATA_RECEITA) a LEFT JOIN (SELECT DATA_RECEITA, TARIFA_CONVENCIONAL FROM TARIFA) b ON  a.DATA_RECEITA = b.DATA_RECEITA)m left join (select DATA_RECEITA, ROUND(Meta_Tarifa_Equivalente*100,2) as META from RECEITA_PREV WHERE SIGLA_EMPRESA='HP') n where m.DATA_RECEITA=n.DATA_RECEITA