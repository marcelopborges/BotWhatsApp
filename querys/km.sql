SELECT A.DATA_RECEITA, b.MetaKM as META, round(a.KM_OP), round(cast((a.KM_OP/b.MetaKM-1)*100 as FLOAT),2) as 'DESV(%)' FROM ((SELECT DATA_RECEITA, SUM(KM_LINHA) AS KM_OP, SUM(KM_OCIOSA) AS KM_OC,SUM(LITRO_LINHA) AS LITROS FROM KM GROUP BY DATA_RECEITA) a left join (select DATA_RECEITA, MetaKM FROM KM_PREV) b on a.DATA_RECEITA = b.DATA_RECEITA)
