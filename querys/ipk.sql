SELECT E.DATA_RECEITA,E.META_IPK,F.IPK, ROUND((F.IPK/E.META_IPK-1)*100,1) AS DESV FROM (SELECT A.DATA_RECEITA, ROUND(B.META_DEMANDA / A.MetaKM,3) AS META_IPK from (SELECT DATA_RECEITA, MetaKM FROM KM_PREV) A left join (SELECT DATA_RECEITA, META AS META_DEMANDA FROM DEMANDA_PREV WHERE SIGLA_EMPRESA = 'HP'  and PREV_KM_ID_SERVICO ='1') B on  A.DATA_RECEITA = B.DATA_RECEITA GROUP BY A.DATA_RECEITA) E LEFT JOIN (SELECT C.DATA_RECEITA, ROUND(D.DEMANDA/C.KM_T,3) AS IPK FROM (SELECT DATA_RECEITA, ROUND((SUM(KM_LINHA) ),1) AS KM_T FROM KM GROUP BY DATA_RECEITA) C LEFT JOIN (select DATA_RECEITA, ROUND(SUM(PASSAGEIROS_TOTAL)/2,1) AS DEMANDA  From demanda  GROUP BY DATA_RECEITA) D ON C.DATA_RECEITA = D.DATA_RECEITA GROUP BY C.DATA_RECEITA) F ON E.DATA_RECEITA = F.DATA_RECEITA 